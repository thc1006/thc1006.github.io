<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>給自己的工具箱 - ADHD 衛教指南</title>

    <!-- Puter.js：免 API Key 的 Gemini / LLM 代理 -->
    <script src="https://js.puter.com/v2/"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- 自訂樣式 -->
    <style>
        :root {
            --bg-color: #0d1117;
            --text-color: #e5e7eb;
            --card-bg: rgba(31, 41, 55, 0.5);
            --border-color: rgba(75, 85, 99, 0.5);
            --ai-response-bg: rgba(17, 24, 39, 0.8);
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Lexend', 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
        }
        .particle-bg { position: fixed; inset: 0; background-color: var(--bg-color); background-image: radial-gradient(circle at 1px 1px, #374151 1px, transparent 0); background-size: 25px 25px; z-index: -1; }
        .gradient-text { background: linear-gradient(90deg, #60a5fa, #a78bfa, #f472b6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .content-card { background-color: var(--card-bg); border: 1px solid var(--border-color); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); }
        [x-cloak] { display: none !important; }
        .ai-response { background-color: var(--ai-response-bg); border-left: 4px solid #3b82f6; }
        .ai-response p { margin-bottom: 0.75rem; }
        .ai-response strong { color: #93c5fd; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3b82f6; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
    </style>

    <!-- AI Helper using Puter.js -->
    <script>
        function aiHelpers() {
            return {
                async getAiResponse(type, context, state) {
                    state.isLoading = true;
                    state.aiResponse = '';
                    let prompt = '';
                    switch (type) {
                        case 'interpret_gad7':
                            prompt = `請你扮演一位有同理心的心理衛教專家。使用者完成 GAD-7 焦慮量表後，得到了 ${context} 分。請根據這個分數，提供一個溫和且非診斷性的初步解釋。說明這個分數在臨床上通常對應的焦慮程度（例如：輕微、中度），並提醒使用者這「不是診斷」，只是一個參考，真正的評估還是需要和醫師或心理師討論。請避免使用過於肯定的語氣。`;
                            break;
                        case 'generate_diary':
                            prompt = `請你扮演一位細心的生活教練，為一位正在進行藥物治療的ADHD患者，生成一則今天日期（${new Date().toLocaleDateString('zh-TW')}）的「用藥日記」範例。內容需包含：服藥時間、劑量、當天專注力與情緒的主觀感受（有好有壞）、記錄一個具體的副作用（如：食慾普通）、以及睡眠品質。請讓內容看起來真實且生活化。`;
                            break;
                        case 'draft_help_email':
                            prompt = `請你扮演一位醫病關係溝通教練。請為一位初次想尋求諮商協助的ADHD患者，草擬一封給心理諮商所的預約諮詢 Email。信件風格需要誠懇、簡潔，內容需包含：簡單的自我介紹（已確診ADHD）、想預約諮詢的目的（例如：想學習與藥物共存的策略、處理藥物帶來的情緒困擾等），並詢問預約流程與費用。請讓這封信看起來友善且容易發送。`;
                            break;
                    }
                    if (!prompt) { state.isLoading = false; return; }
                    try {
                        const resp = await puter.ai.chat(prompt, { model: 'google/gemini-2.0-flash-lite-001', stream: false });
                        state.aiResponse = (resp?.message?.content || '').replace(/\n/g, '<br>');
                    } catch (e) {
                        console.error('LLM 調用失敗:', e);
                        state.aiResponse = `<p class="text-red-400">AI 無法回應，請稍後再試。錯誤：${e.message}</p>`;
                    } finally { state.isLoading = false; }
                }
            };
        }
    </script>
</head>
<body class="antialiased">
    <div class="particle-bg"></div>

    <header class="container mx-auto px-6 py-6 flex justify-between items-center sticky top-0 z-40 bg-opacity-80 backdrop-blur-md" style="background-color: var(--bg-color);">
        <div class="text-lg font-bold">
            <a href="index.html" class="flex items-center gap-2 hover:opacity-80 transition-opacity">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                返回探索之旅
            </a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <section class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-bold gradient-text mb-4">給自己的工具箱</h1>
            <p class="max-w-3xl mx-auto text-lg text-gray-300">了解知識很重要，但學會如何觀察自己、記錄生活、尋求協助，是讓這趟旅程更順利的關鍵。這裡提供一些實用工具，幫助你成為更了解自己的專家。</p>
        </section>

        <!-- 卡片列表 -->
        <div class="space-y-8 max-w-4xl mx-auto" x-data="aiHelpers()">

            <!-- 卡片一：自我檢測量表 -->
            <div x-data="{ open: false, aiResponse: '', isLoading: false, gad7: [], totalScore: 0, showResult: false, calculateScore() { this.totalScore = this.gad7.reduce((a, b) => Number(a) + Number(b), 0); this.showResult = true; this.getAiResponse('interpret_gad7', this.totalScore, this); } }" class="content-card rounded-lg overflow-hidden">
                <button @click="open = !open" class="w-full text-left p-6 flex justify-between items-center">
                    <h3 class="text-xl font-bold">工具一：自我檢測量表</h3>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform flex-shrink-0" :class="{'rotate-180': open}" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </button>
                <div x-show="open" x-collapse x-cloak class="px-6 pb-6 text-gray-300 border-t border-gray-700">
                    <p class="mt-4 mb-4">定期使用量表，能幫助你量化自己的身心狀態，並在回診時提供醫師更具體的參考。<strong>（注意：這不是診斷，僅為自我觀察工具）</strong></p>
                    
                    <div class="bg-gray-900 p-4 rounded-lg">
                        <h4 class="font-bold text-lg mb-2">廣泛性焦慮量表 (GAD-7) - 互動測試</h4>
                        <p class="text-sm text-gray-400 mb-4">在過去兩週，你多常受到以下問題困擾？</p>
                        <div class="space-y-4">
                            <template x-for="(question, index) in ['感覺緊張、不安或煩躁','不能停止或控制憂慮','過份地擔心許多不同事情','很難放鬆下來','心神不寧，以致坐立難安','變得容易發火或易怒','感覺好像將有可怕的事情發生']" :key="index">
                                <div class="text-sm">
                                    <p x-text="`${index + 1}. ${question}`"></p>
                                    <div class="flex flex-wrap gap-x-4 gap-y-2 mt-2">
                                        <label class="flex items-center"><input type="radio" :name="`q${index}`" x-model="gad7[index]" value="0" class="mr-1"> 完全沒有(0)</label>
                                        <label class="flex items-center"><input type="radio" :name="`q${index}`" x-model="gad7[index]" value="1" class="mr-1"> 幾天(1)</label>
                                        <label class="flex items-center"><input type="radio" :name="`q${index}`" x-model="gad7[index]" value="2" class="mr-1"> 超過一半時間(2)</label>
                                        <label class="flex items-center"><input type="radio" :name="`q${index}`" x-model="gad7[index]" value="3" class="mr-1"> 幾乎每天(3)</label>
                                    </div>
                                </div>
                            </template>
                        </div>
                        <button @click="calculateScore()" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm" :disabled="gad7.length < 7">計算總分 & AI 解說</button>
                        <div x-show="showResult" class="mt-4">
                            <p>你的總分是：<strong x-text="totalScore" class="text-xl"></strong></p>
                            <div x-show="isLoading" class="mt-2 flex items-center gap-3"><div class="loader"></div><span>AI 解說生成中...</span></div>
                            <div x-show="aiResponse" x-cloak class="mt-2 p-4 rounded-lg ai-response" x-html="aiResponse"></div>
                        </div>
                    </div>

                    <div class="mt-6">
                         <h4 class="font-bold text-lg mb-2">其他推薦量表</h4>
                         <ul class="list-disc list-inside text-sm space-y-2">
                             <li><strong class="text-white">睡眠品質 (PSQI):</strong> 涵蓋多面向的睡眠狀況，適合每月評估。</li>
                             <li><strong class="text-white">衝動控制 (BIS-11):</strong> 經典的衝動性評估量表，追蹤治療前後的變化。</li>
                         </ul>
                    </div>
                </div>
            </div>

            <!-- 卡片二：用藥日記 -->
            <div x-data="{ open: false, aiResponse: '', isLoading: false }" class="content-card rounded-lg overflow-hidden">
                <button @click="open = !open" class="w-full text-left p-6 flex justify-between items-center">
                    <h3 class="text-xl font-bold">工具二：我的用藥日記</h3>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform flex-shrink-0" :class="{'rotate-180': open}" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </button>
                <div x-show="open" x-collapse x-cloak class="px-6 pb-6 text-gray-300 border-t border-gray-700">
                    <p class="mt-4 mb-4">人的記憶不可靠，但紀錄是客觀的。一份好的用藥日記，是回診時與醫師溝通最有力的工具。它能幫助你和醫生一起找到最適合你的治療方案。</p>
                    <div class="bg-gray-900 p-4 rounded-lg text-sm">
                        <h4 class="font-semibold text-white mb-2">日記範本建議欄位：</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-gray-700"><tr><th class="py-2 pr-2">日期</th><th class="py-2 pr-2">服藥時間/劑量</th><th class="py-2 pr-2">專注力(1-5分)</th><th class="py-2 pr-2">情緒(1-5分)</th><th class="py-2 pr-2">副作用紀錄</th><th class="py-2">睡眠品質(1-5分)</th></tr></thead>
                                <tbody><tr><td class="py-2 pr-2 text-gray-400">範例...</td><td class="py-2 pr-2 text-gray-400">範例...</td><td class="py-2 pr-2 text-gray-400">範例...</td><td class="py-2 pr-2 text-gray-400">範例...</td><td class="py-2 pr-2 text-gray-400">範例...</td><td class="py-2 text-gray-400">範例...</td></tr></tbody>
                            </table>
                        </div>
                    </div>
                    <!-- AI 工具區 -->
                    <div class="mt-6 pt-4 border-t border-gray-700">
                        <h4 class="text-lg font-bold mb-3 flex items-center"><span class="mr-2 text-2xl">✨</span> AI 探索工具</h4>
                        <div class="flex flex-wrap gap-4">
                           <button @click="getAiResponse('generate_diary', '', $data)" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm">AI 幫我產生今日日記範例</button>
                        </div>
                        <div x-show="isLoading" class="mt-4 flex items-center gap-3"><div class="loader"></div><span>AI 思考中...</span></div>
                        <div x-show="aiResponse" x-cloak class="mt-4 p-4 rounded-lg ai-response" x-html="aiResponse"></div>
                    </div>
                </div>
            </div>

            <!-- 卡片三：在地資源 -->
             <div x-data="{ open: false, aiResponse: '', isLoading: false }" class="content-card rounded-lg overflow-hidden">
                <button @click="open = !open" class="w-full text-left p-6 flex justify-between items-center">
                    <h3 class="text-xl font-bold">工具三：台灣在地資源</h3>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform flex-shrink-0" :class="{'rotate-180': open}" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </button>
                <div x-show="open" x-collapse x-cloak class="px-6 pb-6 text-gray-300 border-t border-gray-700">
                    <p class="mt-4 mb-4">你不是一個人。台灣有許多組織和社群，提供給ADHD患者與家庭支持、資訊和溫暖的交流。踏出尋求協助的第一步，非常勇敢。</p>
                    <div class="space-y-4 text-sm">
                        <div>
                            <h4 class="font-semibold text-white">病友與家庭支持協會</h4>
                            <ul class="list-disc list-inside mt-1 space-y-1">
                                <li><a href="https://www.adhd.org.tw/" target="_blank" class="text-blue-400 hover:underline">社團法人台灣赤子心過動症協會</a> - 歷史悠久，提供家長支持、講座與營隊。</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-white">線上社群</h4>
                            <ul class="list-disc list-inside mt-1 space-y-1">
                                <li>Facebook 上有許多活躍的私密社團，如「<a href="http://facebook.com/groups/ADHDTW" target="_blank" class="text-blue-400 hover:underline">台灣ADHD(注意力不足過動症)交流園地</a>」，提供同儕經驗分享（請注意資訊需審慎判讀）。</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-white">心理諮商資源</h4>
                            <ul class="list-disc list-inside mt-1 space-y-1">
                                <li>各地區心理衛生中心、大專院校諮商中心，以及自費心理諮商所，皆可尋求專業心理師的協助。</li>
                            </ul>
                        </div>
                    </div>
                    <!-- AI 工具區 -->
                    <div class="mt-6 pt-4 border-t border-gray-700">
                        <h4 class="text-lg font-bold mb-3 flex items-center"><span class="mr-2 text-2xl">✨</span> AI 探索工具</h4>
                        <div class="flex flex-wrap gap-4">
                           <button @click="getAiResponse('draft_help_email', '', $data)" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm">AI 幫我草擬求助信</button>
                        </div>
                        <div x-show="isLoading" class="mt-4 flex items-center gap-3"><div class="loader"></div><span>AI 思考中...</span></div>
                        <div x-show="aiResponse" x-cloak class="mt-4 p-4 rounded-lg ai-response" x-html="aiResponse"></div>
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <footer class="text-center mt-16 md:mt-24 py-8 px-6 border-t border-gray-800">
        <div class="container mx-auto">
             <p class="mb-4 text-sm text-gray-500">AI 生成內容僅供參考，不能取代專業醫療建議。所有內容均基於本頁面提供的公開研究資料生成。</p>
            <p class="mb-4 text-gray-400">&copy; 2025 ADHD 神經探索地圖. </p>
            <div class="flex justify-center items-center space-x-2 text-sm text-gray-500">
                <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" class="hover:text-gray-300">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height: 1.2em; display: inline-block; vertical-align: middle;" alt="Creative Commons">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height: 1.2em; display: inline-block; vertical-align: middle;" alt="Attribution">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" style="height: 1.2em; display: inline-block; vertical-align: middle;" alt="Share Alike">
                </a>
                <span>本網站內容採用 <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" class="underline hover:text-gray-300">姓名標示-相同方式分享 4.0 國際</a> 授權條款釋出。</span>
            </div>
        </div>
    </footer>
    
</body>
</html>
